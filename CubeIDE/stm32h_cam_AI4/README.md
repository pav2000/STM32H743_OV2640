Пример 4 X-CUBE.AI для CubeMX IDE.<br>
Пакет X-CUBE-AI расширяет функциональные возможности среды STM32CubeMX, добавляя в нее автоматический генератор библиотеки
нейронной сети. Этот генератор преобразует файлы моделей предварительно обученных нейронных сетей, формируемые различными
фреймворками глубокого обучения (такими как Caffe, Keras, Lasagne, TensorFlow™ Lite и ConvNetJs), в оптимизированную по
скорости выполнения и объему памяти (ОЗУ и Flash) библиотеку. Сгенерированная библиотека автоматически интегрируется с
пользовательским приложением, в результате чего на выходе получается полностью настроенный проект, готовый к компиляции и
исполнению на микроконтроллере STM32.<br>
Пакет расширения X-CUBE-AI предназначен для создания проектов с поддержкой ИИ на базе микроконтроллеров STM32
с ядрами ARM® Cortex®-M.Текущая версия примера использует:<br>
- X-CUBE-AI версии 8.0.0; <br>
- клиентское API нейронной сети версии 1.2.0;<br>
- утилита командной строки версии 1.7.0.<br>
Предварительно обученная DL-модель Keras, используется в данном примере.<br>
<br>
Четвертый пример использования X-CUBE.AI.
Используется нейросеть обученная на распознавание 10 классов (рукописные цифры dataset NMIST).<br>
Набор тысяч 28x28px бинарных изображений рукописных цифр от 0 до 9: Оригинальная база данных MNIST содержит
60 000 примеров для обучения и 10 000 примеров для тестирования, ее можно можно загрузить с сайта LeCun. <br>
<img src="https://github.com/pav2000/STM32H743_OV2640/blob/main/CubeIDE/stm32h_cam_AI4/picture/NMIST.png" width="280" /> <br><br>
Нейросеть имеет на входе картинку 28х28х1 (монохромное изображение), где первые два числа ширина и высота обрабатываемого изображения. Камера выдает картинку 160х160 пикселей и при формировании входного массива нейросети
используется прореживание точек (берется каждая пятая точка по вертикали и горизонтали) или усреднение массива точек 5х5.<br>
<br>
Кнопка SELECT - ставит процесс распознавания на паузу. Кнопка ENTER включает/отключает усреднение точек по маске 5х5 точек, если
эта опция не включена то работает прореживание - берется каждая пятая точка на изображении.<br>
Слева экрана выводится все классы с определенными вероятностями.<br>
Внизу экрана выводится частота обновления кадров.<br>
<br>
Важно!<br>
Мною было замечено, что при изменении в Cube.MX параметров нейрости (возможно еще чего?), происходит спонтанное переключение на
тактирование от внутренней RC цепочки и сброс внешнего кварца на 8 МГц. Необходимо проверять в Cube.MX - использование внешнего
кварца и установка его частоты на 25 МГц. В противном случае пример не будет работать. Также после новой генерации кода
необходимо закоментировать вызовы MX_X_CUBE_AI_Process() и MX_X_CUBE_AI_Init() (это шаблон X-CUBE.AI), в примере им написаны альтернативы.
<br>
Результат распознавания получился не очень качественным, сеть часто ошибается, модель надо оптимизировать.<br>
Результаты работы на целевом устройстве - пример распознавания некоторых классов.<br>
<img src="https://github.com/pav2000/STM32H743_OV2640/blob/main/CubeIDE/stm32h_cam_AI4/picture/2.jpg" width="320" /> <br>
<img src="https://github.com/pav2000/STM32H743_OV2640/blob/main/CubeIDE/stm32h_cam_AI4/picture/9.jpg" width="320" /> <br>
<img src="https://github.com/pav2000/STM32H743_OV2640/blob/main/CubeIDE/stm32h_cam_AI4/picture/4.jpg" width="320" /> <br>
<br>
<br>

