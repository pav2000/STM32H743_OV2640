Пример 3 X-CUBE.AI для CubeMX IDE.<br>
Пакет X-CUBE-AI расширяет функциональные возможности среды STM32CubeMX, добавляя в нее автоматический генератор библиотеки
нейронной сети. Этот генератор преобразует файлы моделей предварительно обученных нейронных сетей, формируемые различными
фреймворками глубокого обучения (такими как Caffe, Keras, Lasagne, TensorFlow™ Lite и ConvNetJs), в оптимизированную по
скорости выполнения и объему памяти (ОЗУ и Flash) библиотеку. Сгенерированная библиотека автоматически интегрируется с
пользовательским приложением, в результате чего на выходе получается полностью настроенный проект, готовый к компиляции и
исполнению на микроконтроллере STM32.<br>
Пакет расширения X-CUBE-AI предназначен для создания проектов с поддержкой ИИ на базе микроконтроллеров STM32
с ядрами ARM® Cortex®-M.Текущая версия примера использует:<br>
- X-CUBE-AI версии 8.0.0; <br>
- клиентское API нейронной сети версии 1.2.0;<br>
- утилита командной строки версии 1.7.0.<br>
Предварительно обученная DL-модель Keras, используется в данном примере.<br>
<br>
Третий пример использования X-CUBE.AI.
Используется нейросеть обученная на распознавание 10 классов (dataset CIFAR10).<br>
Набор данных CIFAR-10 состоит из 60000 32×32 затеняющих изображений в 10 классах, по 6000 изображений для каждого класса.
Набор данных разделен на пять подготавливающих кусков и одну тестовую группу, каждая из которых содержит 10000 фотографий.
Тестовая группа содержит ровно 1000 беспорядочно выбранных снимков для каждого класса. Кластеры подготовки содержат остальные
картинки в произвольных запросах, однако некоторые группы подготовки могут содержать больше картинок из одного класса, чем из
другого. Между ними группы подготовки содержат ровно 5000 картинок из каждого класса.<br>
Классы в наборе  CIFAR10 <br>
- самолет<br>
- автомобиль<br>
- птица<br>
- кошка<br>
- олень<br>
- собака<br>
- лягушка<br>
- лошадь<br>
- корабль<br>
- грузовик<br>
Насколько мне известно на данный момент есть статьи в которых заявляется решение задачи классификации на данном датасете с
точностью выше 99.0% (см., например, [A. Kolesnikov, L. Beyer, X. Zhai, J. Puigcerver, J. Yung, S. Gelly, N. Houlsby
“Big Transfer (BiT): General Visual Representation Learning”, arXiv:1912.11370v3, 2019] в которой заявлена точность 99.37%).
Но я задачи собрать сеть, которая бы достигла “state of the arts” перед собой в данном случае не ставил. Интересен был на
самом деле не абсолютный результат, а относительные изменения при добавлении и удалении разных компонент.
Нейросеть имеет на входе картинку 32х32х3, где первые два числа ширина и выстота обрабатываемого изображения,
3 это RGB компоненты цвета. Камера выдает картинку 160х160 пикселей и при формировании входного массива нейросети
используется прореживание точек (берется каждая вторая точка по вертикали и горизонтали). Этот метод не является оптимальным,
лучше использовать алгоритм сжатия, который усредняет соседние точки.<br>

Кнопка SELECT - ставит процесс распознавания на паузу. Кнопка ENTER показывает/выключает рамку на изображении которая
указывает область обработки нейросетью.<br>
Внизу экрана выводится какой классы с определенными вероятностями по обоим классам (cat/dog).<br>
также внизу экрана выводится частота обновления кадров.<br>
Мною было замечено, что при изменении в Cube.MX параметров нейрости (возможно еще чего?), происходит спонтанное переключение на
тактирование от внутренней RC цепочки и сброс внешнего кварца на 8 МГц. Необходимо проверять в Cube.MX - использование внешнего
кварца и установка его частоты на 25 МГц.В противном случае пример не будет работать. Также после новой генерации кода
необходимо закоментировать вызовы MX_X_CUBE_AI_Process() и MX_X_CUBE_AI_Init(), в примере им написаны альтернативы.
<br>
Создание нейросети с входами 80х80 точек.<br>
<img src="https://github.com/pav2000/STM32H743_OV2640/blob/main/CubeIDE/stm32h_cam_AI2/picture/cat_dog_80x80.jpg" width="640" /> <br>
Использование X-CUBE.AI (используемая память)<br>
<img src="https://github.com/pav2000/STM32H743_OV2640/blob/main/CubeIDE/stm32h_cam_AI2/picture/cube01.jpg" width="480" /> <br>
<img src="https://github.com/pav2000/STM32H743_OV2640/blob/main/CubeIDE/stm32h_cam_AI2/picture/cube02.jpg" width="480" /> <br>
Результаты работы на целевом устройстве - пример распознования двух классов<br>
<img src="https://github.com/pav2000/STM32H743_OV2640/blob/main/CubeIDE/stm32h_cam_AI2/picture/dog01.jpg" width="360" /> <br>
<img src="https://github.com/pav2000/STM32H743_OV2640/blob/main/CubeIDE/stm32h_cam_AI2/picture/cat01.jpg" width="360" /> <br>
<br>
<br>

